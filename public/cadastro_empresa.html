<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - NAVIX</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://kit.fontawesome.com/6921956092.js" crossorigin="anonymous"></script>
    <link rel="icon" href="./assets/navix-logo.jpg">
    <link rel="stylesheet" href="./css/index.css">

</head>

<body class="bg-slate-100 min-h-screen flex flex-col">
    <header class="h-30 w-full px-15 flex items-center justify-between fixed bg-slate-900 bg-opacity-50">
        <div>
            <a href="index.html">
                <div class="h-22 w-22 bg-slate-300 rounded-full" id="logo"></div>
            </a>
        </div>
        <div class="w-120 content-center">
            <ul class="flex justify-between cabecalho">
                <a href="./index.html" class="content-center">
                    <li class="text-slate-100">Home</li>
                </a>
                <a href="./aboutUs.html" class="content-center">
                    <li class="text-slate-100">Sobre nós</li>
                </a>
                <a href="./login.html">
                    <li
                        class="border border-4 border-solid border-slate-100 pb-2 pt-2 pl-7 pr-7 rounded-sm text-slate-100">
                        Entrar</li>
                </a>
                <a href="./cadastro.html" class="content-center pl-7 pr-7 rounded-sm bg-slate-100" <li
                    class="text-blue-950">
                    Cadastro</li>
                </a>
            </ul>
        </div>
    </header>
    <div class="bg-slate-200 flex-grow flex items-center justify-center px-6 py-6 h-screen">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg mt-40 p-10">

            <h1 class="text-3xl font-bold text-blue-900 mb-6 text-center">Cadastro da Empresa</h1>

            <div id="cardMensagem" class="hidden px-4 py-3 rounded mb-4">
                <span id="mensagem_status"></span>
            </div>

            <form onsubmit="event.preventDefault(); cadastrar_empresa();" class="flex flex-col gap-4">

                <input id="razaoSocial_input" type="text" placeholder="Razão Social"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="cnpj_input" type="text" placeholder="CNPJ (somente números)"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="codigo_ativacao_input" type="text" placeholder="Código de Ativação"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="cep_input" type="text" placeholder="CEP"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="estado_input" type="text" placeholder="Estado"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="cidade_input" type="text" placeholder="Cidade"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="bairro_input" type="text" placeholder="Bairro"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="rua_input" type="text" placeholder="Rua"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <input id="numero_input" type="text" placeholder="Número"
                    class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

                <button type="submit" class="w-full bg-blue-900 text-white py-3 rounded hover:bg-blue-800 transition">
                    Cadastrar
                </button>
            </form>


            <p class="mt-4 text-center text-gray-600 text-sm">
                Já tem uma conta? <a href="login.html" class="text-blue-800 font-semibold">Entrar</a>
            </p>
        </div>
    </div>
    <div
        class="bg-slate-100 text-blue-950 flex flex-col justify-between lg:flex-row justify-between px-6 md:px-16 w-full py-16 gap-10 max-lg:items-center">
        <div class="flex flex-col justify-center gap-7 items-start">
            <div class="max-lg:flex w-[100%] justify-center">
                <p class="text-2xl md:text-3xl">Entre em contato</p>
            </div>
            <div class="flex flex-col gap-5 max-lg:w-[100%]">
                <div class="flex gap-2 items-center max-lg:justify-center">
                    <i class="fa-solid fa-location-dot text-xl md:text-2xl"></i>
                    <p class="text-base md:text-xl">Haddock Lobo, 595 </p>
                </div>
                <div class="flex gap-2 items-center max-lg:justify-center">
                    <i class="fa-solid fa-envelope text-xl md:text-2xl"></i>
                    <p class="text-base md:text-xl">navix@gmail.com</p>
                </div>
                <div class="flex gap-2 items-center max-lg:justify-center">
                    <i class="fa-solid fa-phone text-xl md:text-2xl"></i>
                    <p class="text-base md:text-xl">(11)99999-9999 </p>
                </div>
            </div>
        </div>
        <div class="flex flex-col justify-center items-center max-w-lg gap-5 text-center max-lg:w-300">
            <div class="flex gap-3 flex-wrap justify-center">
                <div class="h-16 w-16 md:h-20 md:w-20 bg-slate-300 rounded-full flex items-center justify-center"><i
                        class="fa-brands fa-instagram text-2xl md:text-3xl"></i></div>
                <div class="h-16 w-16 md:h-20 md:w-20 bg-slate-300 rounded-full flex items-center justify-center"><i
                        class="fa-brands fa-facebook text-2xl md:text-3xl"></i></div>
                <div class="h-16 w-16 md:h-20 md:w-20 bg-slate-300 rounded-full flex items-center justify-center"><i
                        class="fa-brands fa-x-twitter text-2xl md:text-3xl"></i></div>
                <div class="h-16 w-16 md:h-20 md:w-20 bg-slate-300 rounded-full flex items-center justify-center"><i
                        class="fa-brands fa-tiktok text-2xl md:text-3xl"></i></div>
            </div>
            <p class="text-base md:text-xl leading-relaxed">
                Para acompanhar novidades sobre o desenvolvimento do projeto siga Navix nas redes sociais e conecte-se
                com o projeto
            </p>
        </div>
        <div class="flex flex-col justify-center items-start gap-3">
            <div>
                <p class="text-lg md:text-2xl">Quer fazer parte do projeto?</p>
                <p class="text-lg md:text-2xl">Informe seu email</p>
            </div>
            <input type="text" class="px-4 rounded-sm py-2 bg-slate-200 w-full max-w-sm"
                placeholder="exemplo@email.com">
            <a href=""
                class="px-6 py-3 bg-blue-700 rounded-sm text-slate-100 scale-100 hover:scale-110 transition-transform duration-300 transform-gpu">Enviar</a>
        </div>

        <div id="loading"
            class="hidden fixed inset-0 flex items-center justify-center z-50 backdrop-blur-sm bg-white/30">
            <div class="w-16 h-16 border-4 border-blue-900 border-t-transparent rounded-full animate-spin"></div>
        </div>
    </div>
</body>

</html>
<script>
    console.log("Está abrindo o script")

    //import { sumirMensagem } from '../sessao.js';

    function mostrarMensagem(tipo, texto) {
        const card = document.getElementById("cardMensagem");
        const mensagem = document.getElementById("mensagem_status");

        mensagem.textContent = texto;

        card.className = "px-4 py-3 rounded mb-4";

        if (tipo === "sucesso") {
            card.classList.add("bg-green-200", "text-green-800");
        } else {
            card.classList.add("bg-red-200", "text-red-800");
        }

        card.classList.remove("hidden");
        // setTimeout(sumirMensagem, 7000);
    }

    // function mostrarLoading() {
    //     document.getElementById('loading').classList.remove('hidden');
    // }

    // function esconderLoading() {
    //     document.getElementById('loading').classList.add('hidden');
    // }

    async function cadastrar_empresa() {
        var razaoSocial = razaoSocial_input.value;
        var cnpj = cnpj_input.value;
        var numero = numero_input.value;
        var cep = cep_input.value;
        var estado = estado_input.value;
        var cidade = cidade_input.value;
        var bairro = bairro_input.value;
        var rua = rua_input.value;
        var codigoAtivacao = codigo_ativacao_input.value;

        const verificacao = [razaoSocial, cnpj];

        if (verificacao.includes("")) {
            esconderLoading();
            return mostrarMensagem("erro", "Campos inválidos! Deve-se preencher todos os campos");
        } else if (razaoSocial.length < 3) {
            esconderLoading();
            return mostrarMensagem("erro", "Razão social inválida! Mínimo 3 caracteres");
        } else if (!/^\d{14}$/.test(cnpj)) {
            esconderLoading();
            return mostrarMensagem("erro", "CNPJ inválido! Deve conter exatamente 14 dígitos numéricos.");
        }

        try {
            const resposta = await fetch("empresa/cadastrar", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    razaoSocialServer: razaoSocial,
                    cnpjServer: cnpj,
                    codigoServer: codigoAtivacao,
                    cepServer: cep,
                    estadoServer: estado,
                    cidadeServer: cidade,
                    bairroServer: bairro,
                    ruaServer: rua,
                    numeroServer: numero
                }),
            });

            console.log("resposta: ", resposta.status);

            if (resposta.ok) {
                // mostrarLoading();
                mostrarMensagem("sucesso", "Cadastro realizado com sucesso!");
                setTimeout(() => {
                    window.location = "login.html";
                }, 3000);
            } else {
                // esconderLoading();
                if (resposta.status == 500) {
                    console.log(resposta.status)
                }
                throw new Error("Erro ao cadastrar: " + resposta.status);
            }

        } catch (error) {
            // esconderLoading();
            return mostrarMensagem("erro", error.message || "Erro inesperado ao cadastrar");
        }
    }

    window.cadastrar_empresa = cadastrar_empresa;

</script>