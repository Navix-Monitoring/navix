<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - NAVIX</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://kit.fontawesome.com/6921956092.js" crossorigin="anonymous"></script>
    <link rel="icon" href="./assets/navix-logo.jpg">
    <link rel="stylesheet" href="./css/index.css">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet" />
</head>

<body class="bg-slate-100 min-h-screen flex flex-col">
    <!-- HEADER -->
    <header class="w-full px-4 sm:px-8 md:px-15 flex items-center justify-between fixed bg-slate-900 bg-opacity-50 z-50 h-16 md:h-20">
        <div>
            <a href="index.html">
                <div class="h-10 w-10 md:h-14 md:w-14 bg-slate-300 rounded-full" id="logo"></div>
            </a>
        </div>
        <nav class="hidden md:flex space-x-6">
            <a href="./index.html" class="text-slate-100 hover:text-blue-400 transition">Home</a>
            <a href="./aboutUs.html" class="text-slate-100 hover:text-blue-400 transition">Sobre nós</a>
            <a href="./login.html" class="border border-slate-100 px-4 py-1 rounded text-slate-100 hover:bg-blue-800 transition">
                Entrar
            </a>
        </nav>
        <div class="md:hidden">
            <button id="menuBtn" class="text-slate-100 text-2xl">&#9776;</button>
        </div>
    </header>

<main class="flex h-screen items-center justify-center px-4 sm:px-6 pt-16">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl p-8">
    <h1 class="text-3xl font-bold text-blue-900 mb-6 text-center">Cadastro da Empresa</h1>

    <div id="cardMensagem" class="hidden px-4 py-3 rounded mb-4">
        <span id="mensagem_status"></span>
    </div>

    <form onsubmit="event.preventDefault(); cadastrar_empresa();" class="grid grid-cols-1 sm:grid-cols-2 gap-4">

        <!-- Coluna esquerda -->
        <input id="razaoSocial_input" type="text" placeholder="Razão Social"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <input id="cnpj_input" type="number" placeholder="CNPJ (somente números)"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <input id="codigo_ativacao_input" type="text" placeholder="Código de Ativação"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <input id="cep_input" type="number" placeholder="CEP"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

        <!-- Coluna direita -->
        <input id="estado_input" type="text" placeholder="Estado"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <input id="cidade_input" type="text" placeholder="Cidade"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <input id="bairro_input" type="text" placeholder="Bairro"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <input id="rua_input" type="text" placeholder="Rua"
            class="px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

        <!-- Último input ocupa as duas colunas -->
        <input id="numero_input" type="number" placeholder="Número"
            class="col-span-1 sm:col-span-2 px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />

        <!-- Botão ocupa as duas colunas -->
        <button type="submit"
            class="col-span-1 sm:col-span-2 bg-blue-900 text-white py-3 px-8 rounded hover:bg-blue-800 transition hover:cursor-pointer mt-2 text-lg">
            Cadastrar
        </button>
    </form>

    <p class="mt-4 text-center text-gray-600 text-sm">
        Já tem uma conta? <a href="login.html" class="text-blue-800 font-semibold hover:underline">Entrar</a>
    </p>
</div>

    </main>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        async function cadastrar_empresa() {
            const razaoSocial = document.getElementById("razaoSocial_input").value;
            const cnpj = document.getElementById("cnpj_input").value;
            const codigoAtivacao = document.getElementById("codigo_ativacao_input").value;
            const cep = document.getElementById("cep_input").value;
            const estado = document.getElementById("estado_input").value;
            const cidade = document.getElementById("cidade_input").value;
            const bairro = document.getElementById("bairro_input").value;
            const rua = document.getElementById("rua_input").value;
            const numero = document.getElementById("numero_input").value;

            if (!razaoSocial || !cnpj || !codigoAtivacao || !cep || !estado || !cidade || !bairro || !rua || !numero) {
                Swal.fire({
                    icon: "warning",
                    title: "Aviso",
                    text: "Todos os campos precisam ser preenchidos!",
                    background: "#0f172b",
                    color: "#f1f1f1",
                });
                return false;
            }

            try {
                const resposta = await fetch("empresa/cadastrar", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        razaoSocialServer: razaoSocial,
                        cnpjServer: cnpj,
                        codigoServer: codigoAtivacao,
                        cepServer: cep,
                        estadoServer: estado,
                        cidadeServer: cidade,
                        bairroServer: bairro,
                        ruaServer: rua,
                        numeroServer: numero
                    }),
                });

                if (resposta.ok) {
                    Swal.fire({
                        title: "Empresa cadastrada com sucesso!",
                        text: "Redirecionando para a tela de Login...",
                        icon: "success",
                        timer: 3000,
                        showConfirmButton: false,
                        background: "#141414",
                        color: "#f1f1f1",
                    });
                    setTimeout(() => window.location = "login.html", 3000);
                } else {
                    const erro = await resposta.json();
                    Swal.fire({
                        title: "Erro ao cadastrar!",
                        text: erro.mensagem || "Houve um erro no servidor. Tente novamente.",
                        icon: "error",
                        background: "#141414",
                        color: "#f1f1f1",
                    });
                }
            } catch (erro) {
                Swal.fire({
                    title: "Erro na comunicação!",
                    text: "Não foi possível se conectar ao servidor. Verifique sua conexão.",
                    icon: "error",
                    background: "#141414",
                    color: "#f1f1f1",
                });
            }

            return false;
        }

        window.cadastrar_empresa = cadastrar_empresa;
    </script>
</body>
</html>
